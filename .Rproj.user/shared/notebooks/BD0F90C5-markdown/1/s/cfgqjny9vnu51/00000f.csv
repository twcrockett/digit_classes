"0","#| warning: false"
"0","#| output: false"
"0","#| echo: false"
"0",""
"0","def lda_classifier(X_train, X_test, y_train, y_test, solver, shrinkage):"
"0","    # Scale data"
"0","    scaler = StandardScaler()"
"0","    X_train_scaled = scaler.fit_transform(X_train)"
"0","    X_test_scaled = scaler.transform(X_test)"
"0","    "
"0","    # Train LDA classifier"
"0","    clf = LinearDiscriminantAnalysis(solver=solver, shrinkage=shrinkage)"
"0","    clf.fit(X_train_scaled, y_train)"
"0","    "
"0","    # Predict"
"0","    y_pred = clf.predict(X_test_scaled)"
"0","    "
"0","    return y_pred"
"0","    "
"0","lda_results = []"
"0",""
"0","for params in ParameterGrid(param_grids[""LDA""]):"
"0","    if params['solver'] == 'svd' and params['shrinkage'] is not None:"
"0","      continue"
"0","  "
"0","    # Track metrics across folds"
"0","    fold_accuracies = []"
"0","    fold_precisions = []"
"0","    fold_recalls = []"
"0","    fold_times = []"
"0","    "
"0","    print(f""Testing LDA model with solver={params['solver']}, shrinkage={params['shrinkage']}"")"
"0","    "
"0","    # Perform k-fold cross-validation"
"0","    for fold_idx, (train_idx, test_idx) in enumerate(skf.split(X, y)):"
"0","        X_train, X_test = X[train_idx], X[test_idx]"
"0","        y_train, y_test = y[train_idx], y[test_idx]"
"0","        "
"0","        start_time = time.time()"
"0","        y_pred = lda_classifier(X_train, X_test, y_train, y_test, params['solver'], params['shrinkage'])"
"0","        elapsed_time = time.time() - start_time"
"0","        fold_times.append(elapsed_time)"
"0","        "
"0","        accuracy = accuracy_score(y_test, y_pred)"
"0","        report = classification_report(y_test, y_pred, output_dict=True)"
"0","        precision = report['weighted avg']['precision']"
"0","        recall = report['weighted avg']['recall']"
"0","        "
"0","        # Store results for this fold"
"0","        fold_accuracies.append(accuracy)"
"0","        fold_precisions.append(precision)"
"0","        fold_recalls.append(recall)"
"0","        "
"0","        print(f""  Fold {fold_idx+1}/{skf.n_splits}: Accuracy={accuracy:.4f}, Precision={precision:.4f}, Recall={recall:.4f}, Time={elapsed_time:.2f}s"")"
"0","    "
"0","    # Compute average metrics across all folds"
"0","    mean_accuracy = np.mean(fold_accuracies)"
"0","    mean_precision = np.mean(fold_precisions)"
"0","    mean_recall = np.mean(fold_recalls)"
"0","    total_time = sum(fold_times)"
"0","    f1_score = 2 * (mean_precision * mean_recall) / (mean_precision + mean_recall)"
"0","    "
"0","    # Store results for this parameter combination"
"0","    result = {"
"0","        'solver': params['solver'],"
"0","        'shrinkage': params['shrinkage'],"
"0","        'mean_accuracy': mean_accuracy,"
"0","        'mean_precision': mean_precision,"
"0","        'mean_recall': mean_recall,"
"0","        'f1_score': f1_score,"
"0","        'total_time': total_time"
"0","    }"
"0","    lda_results.append(result)"
"0","    "
"0","    print(f""  Average: Accuracy={mean_accuracy:.4f}, Precision={mean_precision:.4f}, Recall={mean_recall:.4f}, F1={f1_score:.4f}, Time={total_time:.2f}s"")"
"0","    "
"0","lda_df = calculate_selection_score(pd.DataFrame(lda_results))"
"1","Testing LDA model with solver=svd, shrinkage=None
  Fold 1/5: Accuracy=0.9108, Precision=0.9134, Recall=0.9108, Time=0.20s
"
"1","  Fold 2/5: Accuracy=0.9156, Precision=0.9177, Recall=0.9156, Time=0.25s
  Fold 3/5: Accuracy=0.9204, Precision=0.9217, Recall=0.9204, Time=0.20s
"
"1","  Fold 4/5: Accuracy=0.9150, Precision=0.9168, Recall=0.9150, Time=0.19s
  Fold 5/5: Accuracy=0.9236, Precision=0.9248, Recall=0.9236, Time=0.24s
  Average: Accuracy=0.9171, Precision=0.9189, Recall=0.9171, F1=0.9180, Time=1.07s
Testing LDA model with solver=lsqr, shrinkage=None
"
"1","  Fold 1/5: Accuracy=0.9108, Precision=0.9134, Recall=0.9108, Time=0.17s
  Fold 2/5: Accuracy=0.9156, Precision=0.9177, Recall=0.9156, Time=0.18s
  Fold 3/5: Accuracy=0.9204, Precision=0.9217, Recall=0.9204, Time=0.13s
  Fold 4/5: Accuracy=0.9150, Precision=0.9168, Recall=0.9150, Time=0.14s
"
"1","  Fold 5/5: Accuracy=0.9236, Precision=0.9248, Recall=0.9236, Time=0.14s
  Average: Accuracy=0.9171, Precision=0.9189, Recall=0.9171, F1=0.9180, Time=0.75s
Testing LDA model with solver=eigen, shrinkage=None
  Fold 1/5: Accuracy=0.9108, Precision=0.9134, Recall=0.9108, Time=0.19s
"
"1","  Fold 2/5: Accuracy=0.9156, Precision=0.9177, Recall=0.9156, Time=0.18s
  Fold 3/5: Accuracy=0.9204, Precision=0.9217, Recall=0.9204, Time=0.18s
  Fold 4/5: Accuracy=0.9150, Precision=0.9168, Recall=0.9150, Time=0.16s
"
"1","  Fold 5/5: Accuracy=0.9236, Precision=0.9248, Recall=0.9236, Time=0.17s
  Average: Accuracy=0.9171, Precision=0.9189, Recall=0.9171, F1=0.9180, Time=0.87s
Testing LDA model with solver=lsqr, shrinkage=auto
  Fold 1/5: Accuracy=0.9118, Precision=0.9132, Recall=0.9118, Time=0.17s
  Fold 2/5: Accuracy=0.9188, Precision=0.9205, Recall=0.9188, Time=0.17s
"
"1","  Fold 3/5: Accuracy=0.9156, Precision=0.9177, Recall=0.9156, Time=0.19s
  Fold 4/5: Accuracy=0.9107, Precision=0.9130, Recall=0.9107, Time=0.17s
  Fold 5/5: Accuracy=0.9231, Precision=0.9240, Recall=0.9231, Time=0.17s
  Average: Accuracy=0.9160, Precision=0.9177, Recall=0.9160, F1=0.9168, Time=0.86s
Testing LDA model with solver=eigen, shrinkage=auto
"
"1","  Fold 1/5: Accuracy=0.9118, Precision=0.9132, Recall=0.9118, Time=0.22s
  Fold 2/5: Accuracy=0.9188, Precision=0.9205, Recall=0.9188, Time=0.22s
"
"1","  Fold 3/5: Accuracy=0.9156, Precision=0.9177, Recall=0.9156, Time=0.21s
  Fold 4/5: Accuracy=0.9107, Precision=0.9130, Recall=0.9107, Time=0.22s
"
"1","  Fold 5/5: Accuracy=0.9231, Precision=0.9240, Recall=0.9231, Time=0.21s
  Average: Accuracy=0.9160, Precision=0.9177, Recall=0.9160, F1=0.9168, Time=1.07s
Testing LDA model with solver=lsqr, shrinkage=0.1
  Fold 1/5: Accuracy=0.9113, Precision=0.9133, Recall=0.9113, Time=0.12s
  Fold 2/5: Accuracy=0.9210, Precision=0.9227, Recall=0.9210, Time=0.13s
  Fold 3/5: Accuracy=0.9177, Precision=0.9197, Recall=0.9177, Time=0.13s
"
"1","  Fold 4/5: Accuracy=0.9145, Precision=0.9166, Recall=0.9145, Time=0.13s
  Fold 5/5: Accuracy=0.9220, Precision=0.9231, Recall=0.9220, Time=0.13s
  Average: Accuracy=0.9173, Precision=0.9191, Recall=0.9173, F1=0.9182, Time=0.64s
Testing LDA model with solver=eigen, shrinkage=0.1
  Fold 1/5: Accuracy=0.9113, Precision=0.9133, Recall=0.9113, Time=0.16s
"
"1","  Fold 2/5: Accuracy=0.9210, Precision=0.9227, Recall=0.9210, Time=0.15s
  Fold 3/5: Accuracy=0.9177, Precision=0.9197, Recall=0.9177, Time=0.15s
  Fold 4/5: Accuracy=0.9145, Precision=0.9166, Recall=0.9145, Time=0.15s
"
"1","  Fold 5/5: Accuracy=0.9220, Precision=0.9231, Recall=0.9220, Time=0.15s
  Average: Accuracy=0.9173, Precision=0.9191, Recall=0.9173, F1=0.9182, Time=0.76s
Testing LDA model with solver=lsqr, shrinkage=0.5
  Fold 1/5: Accuracy=0.9043, Precision=0.9063, Recall=0.9043, Time=0.12s
  Fold 2/5: Accuracy=0.9161, Precision=0.9190, Recall=0.9161, Time=0.14s
  Fold 3/5: Accuracy=0.9059, Precision=0.9081, Recall=0.9059, Time=0.13s
"
"1","  Fold 4/5: Accuracy=0.9032, Precision=0.9051, Recall=0.9032, Time=0.13s
  Fold 5/5: Accuracy=0.9139, Precision=0.9152, Recall=0.9139, Time=0.14s
  Average: Accuracy=0.9087, Precision=0.9108, Recall=0.9087, F1=0.9097, Time=0.67s
Testing LDA model with solver=eigen, shrinkage=0.5
  Fold 1/5: Accuracy=0.9043, Precision=0.9063, Recall=0.9043, Time=0.17s
"
"1","  Fold 2/5: Accuracy=0.9161, Precision=0.9190, Recall=0.9161, Time=0.15s
  Fold 3/5: Accuracy=0.9059, Precision=0.9081, Recall=0.9059, Time=0.15s
  Fold 4/5: Accuracy=0.9032, Precision=0.9051, Recall=0.9032, Time=0.15s
"
"1","  Fold 5/5: Accuracy=0.9139, Precision=0.9152, Recall=0.9139, Time=0.16s
  Average: Accuracy=0.9087, Precision=0.9108, Recall=0.9087, F1=0.9097, Time=0.79s
Testing LDA model with solver=lsqr, shrinkage=0.9
  Fold 1/5: Accuracy=0.8720, Precision=0.8760, Recall=0.8720, Time=0.13s
  Fold 2/5: Accuracy=0.8785, Precision=0.8843, Recall=0.8785, Time=0.13s
  Fold 3/5: Accuracy=0.8737, Precision=0.8789, Recall=0.8737, Time=0.13s
"
"1","  Fold 4/5: Accuracy=0.8709, Precision=0.8757, Recall=0.8709, Time=0.13s
  Fold 5/5: Accuracy=0.8795, Precision=0.8833, Recall=0.8795, Time=0.13s
  Average: Accuracy=0.8749, Precision=0.8796, Recall=0.8749, F1=0.8773, Time=0.65s
Testing LDA model with solver=eigen, shrinkage=0.9
  Fold 1/5: Accuracy=0.8720, Precision=0.8760, Recall=0.8720, Time=0.17s
"
"1","  Fold 2/5: Accuracy=0.8785, Precision=0.8843, Recall=0.8785, Time=0.18s
  Fold 3/5: Accuracy=0.8737, Precision=0.8789, Recall=0.8737, Time=0.16s
  Fold 4/5: Accuracy=0.8709, Precision=0.8757, Recall=0.8709, Time=0.14s
"
"1","  Fold 5/5: Accuracy=0.8795, Precision=0.8833, Recall=0.8795, Time=0.19s
  Average: Accuracy=0.8749, Precision=0.8796, Recall=0.8749, F1=0.8773, Time=0.83s
"
